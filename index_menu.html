<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>RushLife Prototype</title>
<style>
  :root{
    --bg:#0f0f0f;
    --panel:#222;
    --panel2:#2b2b2b;
    --text:#fff;
    --muted:#bdbdbd;
  }
  body{
    margin:0;
    background:var(--bg);
    color:var(--text);
    font-family: Arial, sans-serif;
    height:100vh;
    overflow:hidden;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  #wrap{
    width:min(420px, 100vw);
    height:min(820px, 100vh);
    position:relative;
  }

  /* ==== GAME CANVAS ==== */
  #game{
    width:100%;
    height:100%;
    display:block;
    background:#0b0b0b;
    border-radius:18px;
    box-shadow:0 0 30px rgba(0,0,0,.6);
  }

  /* ==== HUD TOP ==== */
  #hudTop{
    position:absolute;
    top:12px;
    left:12px;
    right:12px;
    display:flex;
    gap:10px;
    align-items:flex-start;
    pointer-events:none;
  }
  .hudCard{
    background:rgba(20,20,20,.75);
    border:1px solid rgba(255,255,255,.08);
    backdrop-filter: blur(6px);
    border-radius:14px;
    padding:10px 12px;
    font-size:13px;
    pointer-events:none;
  }
  #hudLeft{ min-width: 170px; }
  #hudRight{ margin-left:auto; text-align:right; }

  /* ==== PHONE OVERLAY ==== */
  #phoneOverlay{
    position:absolute;
    inset:0;
    display:none;
    align-items:center;
    justify-content:center;
    background:rgba(0,0,0,.55);
  }
  #phone{
    width:340px;
    height:610px;
    border-radius:28px;
    background:linear-gradient(180deg, #1c1c1c, #121212);
    box-shadow:0 0 35px rgba(0,0,0,.75);
    padding:18px;
  }
  #phone h2{ margin:4px 0 8px 0; }
  .muted{ color:var(--muted); font-size:13px; }
  .appbtn{
    width:100%;
    padding:12px 12px;
    margin:8px 0;
    border-radius:12px;
    border:1px solid rgba(255,255,255,.08);
    background:var(--panel2);
    color:var(--text);
    font-size:16px;
  }
  .row{
    display:flex;
    gap:8px;
  }
  .row .appbtn{ flex:1; }

  /* ==== MOBILE CONTROLS ==== */
  #controls{
    position:absolute;
    left:12px; right:12px; bottom:12px;
    display:flex;
    justify-content:space-between;
    gap:12px;
    pointer-events:auto;
  }
  .pad{
    width:168px;
    height:168px;
    border-radius:18px;
    background:rgba(20,20,20,.55);
    border:1px solid rgba(255,255,255,.08);
    display:grid;
    grid-template-columns:repeat(3, 1fr);
    grid-template-rows:repeat(3, 1fr);
    gap:6px;
    padding:10px;
    backdrop-filter: blur(6px);
  }
  .btn{
    border:none;
    border-radius:14px;
    background:rgba(255,255,255,.08);
    color:#fff;
    font-size:18px;
  }
  .btn:active{ transform:scale(.98); }
  .btn.empty{ background:transparent; }

  .actions{
    width:180px;
    display:flex;
    flex-direction:column;
    gap:10px;
  }
  .act{
    padding:12px;
    border-radius:14px;
    border:1px solid rgba(255,255,255,.08);
    background:rgba(20,20,20,.55);
    color:#fff;
    font-size:16px;
    backdrop-filter: blur(6px);
  }
  .act:active{ transform:scale(.99); }

  /* Hide controls on desktop wide if you want (optional) */
</style>
</head>
<body>
<div id="wrap">

  <canvas id="game" width="420" height="820"></canvas>

  <div id="hudTop">
    <div class="hudCard" id="hudLeft"></div>
    <div class="hudCard" id="hudRight"></div>
  </div>

  <!-- Phone overlay -->
  <div id="phoneOverlay">
    <div id="phone">
      <h2>üì± RushLife</h2>
      <div class="muted" id="phoneMeta"></div>
      <hr style="border-color:rgba(255,255,255,.08)">
      <div class="muted" id="phoneStatus"></div>

      <button class="appbtn" onclick="work('delivery')">üö¥ Trabalhar Entrega (+$20)</button>
      <button class="appbtn" onclick="work('uber')">üöó Trabalhar Uber (+$30)</button>
      <div class="row">
        <button class="appbtn" onclick="eat()">üçî Comer (-$15)</button>
        <button class="appbtn" onclick="sleep()">üåô Dormir</button>
      </div>

      <button class="appbtn" onclick="togglePhone()">‚¨ÖÔ∏è Fechar Celular</button>
      <div class="muted" style="margin-top:8px;">
        Dica: Voc√™ pode andar com os bot√µes e abrir o celular a qualquer momento.
      </div>
    </div>
  </div>

  <!-- Mobile controls -->
  <div id="controls">
    <div class="pad">
      <button class="btn empty"></button>
      <button class="btn" id="up">‚¨ÜÔ∏è</button>
      <button class="btn empty"></button>

      <button class="btn" id="left">‚¨ÖÔ∏è</button>
      <button class="btn empty"></button>
      <button class="btn" id="right">‚û°Ô∏è</button>

      <button class="btn empty"></button>
      <button class="btn" id="down">‚¨áÔ∏è</button>
      <button class="btn empty"></button>
    </div>

    <div class="actions">
      <button class="act" onclick="togglePhone()">üì± Celular</button>
      <button class="act" onclick="interact()">ü§ù Interagir</button>
      <button class="act" onclick="toggleWeather()">üå¶Ô∏è Trocar Clima</button>
    </div>
  </div>

</div>

<script>
/* =========================
   GAME STATE
========================= */
const game = {
  day: 1,
  hour: 8,
  minute: 0,
  climate: "Sol", // Sol | Chuva | Nublado | Frio
  hunger: 100,
  energy: 100,
  health: 100,
  money: 50,
  age: 18.00,

  // World
  mapW: 2000,
  mapH: 2000,
  player: { x: 1000, y: 1000, vx:0, vy:0, speed: 180 },
  npcs: [
    { x: 950, y: 1050, vx: 0, vy: 0, dirT: 0, talk:"Oi! Bom dia üòä" },
    { x: 1100, y: 980, vx: 0, vy: 0, dirT: 0, talk:"T√° chovendo hoje?" },
    { x: 1020, y: 1120, vx: 0, vy: 0, dirT: 0, talk:"Trabalhar t√° dif√≠cil..." }
  ],

  phoneOpen: false
};

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

/* =========================
   UI HELPERS
========================= */
function clamp(v, a, b){ return Math.max(a, Math.min(b, v)); }

function fmtTime(){
  const hh = String(game.hour).padStart(2,"0");
  const mm = String(game.minute).padStart(2,"0");
  return `${hh}:${mm}`;
}

function updateHUD(){
  const left =
`üìÖ Dia ${game.day} ‚Ä¢ üïí ${fmtTime()}
üå¶Ô∏è ${game.climate}`;
  const right =
`üí∞ $${game.money}
üçî ${game.hunger}  ‚ö° ${game.energy}
‚ù§Ô∏è ${game.health}  üéÇ ${game.age.toFixed(2)}`;
  document.getElementById("hudLeft").textContent = left;
  document.getElementById("hudRight").textContent = right;

  document.getElementById("phoneMeta").textContent = `Dia ${game.day} ‚Ä¢ ${fmtTime()} ‚Ä¢ Clima: ${game.climate}`;
  document.getElementById("phoneStatus").innerHTML =
    `üí∞ Dinheiro: $${game.money}<br>`+
    `üçî Fome: ${game.hunger}<br>`+
    `‚ö° Energia: ${game.energy}<br>`+
    `‚ù§Ô∏è Sa√∫de: ${game.health}<br>`+
    `üéÇ Idade: ${game.age.toFixed(2)}`;
}

function togglePhone(){
  game.phoneOpen = !game.phoneOpen;
  document.getElementById("phoneOverlay").style.display = game.phoneOpen ? "flex" : "none";
}

function notify(msg){
  // simples: alert por enquanto (depois a gente coloca toast bonito)
  alert(msg);
}

/* =========================
   TIME & STATS
========================= */
function tickMinute(){
  game.minute += 1;
  if(game.minute >= 60){ game.minute = 0; game.hour += 1; }
  if(game.hour >= 24){ game.hour = 0; game.day += 1; }

  // decay suave
  if(game.minute % 6 === 0){ // a cada 6 min
    game.hunger = clamp(game.hunger - 1, 0, 100);
    game.energy = clamp(game.energy - 1, 0, 100);
    if(game.hunger === 0 || game.energy === 0){
      game.health = clamp(game.health - 1, 0, 100);
    }
  }

  updateHUD();
}

setInterval(tickMinute, 1000); // 1s = 1 minuto do jogo (depois ajustamos)

/* =========================
   ACTIONS (PHONE APPS)
========================= */
function work(type){
  if(game.energy <= 10){ notify("Voc√™ est√° muito cansado!"); return; }

  if(type === "delivery"){
    game.money += 20;
    game.energy = clamp(game.energy - 12, 0, 100);
    game.hunger = clamp(game.hunger - 8, 0, 100);
  } else {
    game.money += 30;
    game.energy = clamp(game.energy - 15, 0, 100);
    game.hunger = clamp(game.hunger - 10, 0, 100);
  }

  // avan√ßa tempo
  for(let i=0;i<30;i++) tickMinute(); // +30 min
  updateHUD();
}

function eat(){
  if(game.money < 15){ notify("Sem dinheiro suficiente."); return; }
  game.money -= 15;
  game.hunger = clamp(game.hunger + 30, 0, 100);
  updateHUD();
}

function sleep(){
  // dormir 8 horas
  for(let i=0;i<8*60;i++) tickMinute();
  game.energy = 100;
  game.hunger = clamp(game.hunger - 10, 0, 100);
  game.age = Number((game.age + 0.01).toFixed(2));
  updateHUD();
}

function toggleWeather(){
  const list = ["Sol","Nublado","Chuva","Frio"];
  const idx = list.indexOf(game.climate);
  game.climate = list[(idx+1) % list.length];
  updateHUD();
}

/* =========================
   MOVEMENT (buttons + keyboard)
========================= */
const keys = { up:false, down:false, left:false, right:false };

function setKey(k, v){ keys[k]=v; }

function bindHold(btnId, keyName){
  const el = document.getElementById(btnId);
  const down = () => setKey(keyName, true);
  const up = () => setKey(keyName, false);

  el.addEventListener("touchstart", (e)=>{ e.preventDefault(); down(); }, {passive:false});
  el.addEventListener("touchend", (e)=>{ e.preventDefault(); up(); }, {passive:false});
  el.addEventListener("mousedown", down);
  el.addEventListener("mouseup", up);
  el.addEventListener("mouseleave", up);
}
bindHold("up","up");
bindHold("down","down");
bindHold("left","left");
bindHold("right","right");

window.addEventListener("keydown", (e)=>{
  if(e.key==="ArrowUp"||e.key==="w") keys.up=true;
  if(e.key==="ArrowDown"||e.key==="s") keys.down=true;
  if(e.key==="ArrowLeft"||e.key==="a") keys.left=true;
  if(e.key==="ArrowRight"||e.key==="d") keys.right=true;
  if(e.key===" ") togglePhone();
});
window.addEventListener("keyup", (e)=>{
  if(e.key==="ArrowUp"||e.key==="w") keys.up=false;
  if(e.key==="ArrowDown"||e.key==="s") keys.down=false;
  if(e.key==="ArrowLeft"||e.key==="a") keys.left=false;
  if(e.key==="ArrowRight"||e.key==="d") keys.right=false;
});

/* =========================
   INTERACTION
========================= */
function dist(a,b){
  const dx=a.x-b.x, dy=a.y-b.y;
  return Math.sqrt(dx*dx+dy*dy);
}
function interact(){
  const p = game.player;
  let nearest = null;
  let best = 99999;
  for(const n of game.npcs){
    const d = dist(p,n);
    if(d < best){ best=d; nearest=n; }
  }
  if(nearest && best < 90){
    notify(nearest.talk);
  } else {
    notify("Ningu√©m perto para interagir.");
  }
}

/* =========================
   WORLD RENDER
========================= */
function draw(){
  // camera follows player
  const p = game.player;
  const camX = clamp(p.x - canvas.width/2, 0, game.mapW - canvas.width);
  const camY = clamp(p.y - canvas.height/2, 0, game.mapH - canvas.height);

  // background
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // roads grid
  ctx.fillStyle = "#101010";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // draw simple city blocks
  // roads
  ctx.fillStyle = "#1a1a1a";
  for(let x=0;x<game.mapW;x+=200){
    const sx = x - camX;
    if(sx>-220 && sx<canvas.width+220){
      ctx.fillRect(sx, -20, 60, canvas.height+40);
    }
  }
  for(let y=0;y<game.mapH;y+=200){
    const sy = y - camY;
    if(sy>-220 && sy<canvas.height+220){
      ctx.fillRect(-20, sy, canvas.width+40, 60);
    }
  }

  // weather overlay
  if(game.climate==="Chuva"){
    ctx.fillStyle = "rgba(120,120,255,0.06)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    // rain streaks
    ctx.strokeStyle = "rgba(180,180,255,0.25)";
    ctx.lineWidth = 1;
    for(let i=0;i<80;i++){
      const rx = (Math.random()*canvas.width)|0;
      const ry = (Math.random()*canvas.height)|0;
      ctx.beginPath();
      ctx.moveTo(rx, ry);
      ctx.lineTo(rx+6, ry+18);
      ctx.stroke();
    }
  } else if(game.climate==="Frio"){
    ctx.fillStyle = "rgba(200,240,255,0.06)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
  } else if(game.climate==="Nublado"){
    ctx.fillStyle = "rgba(200,200,200,0.04)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
  }

  // NPCs
  for(const n of game.npcs){
    const x = n.x - camX, y = n.y - camY;
    ctx.fillStyle = "#7bd389";
    ctx.beginPath();
    ctx.arc(x, y, 12, 0, Math.PI*2);
    ctx.fill();

    // little name dot
    ctx.fillStyle = "rgba(255,255,255,0.6)";
    ctx.fillRect(x-10, y-22, 20, 3);
  }

  // Player
  const px = p.x - camX, py = p.y - camY;
  ctx.fillStyle = "#ffd166";
  ctx.beginPath();
  ctx.arc(px, py, 14, 0, Math.PI*2);
  ctx.fill();

  // outline
  ctx.strokeStyle = "rgba(0,0,0,0.4)";
  ctx.lineWidth = 3;
  ctx.stroke();

  requestAnimationFrame(draw);
}

/* =========================
   UPDATE LOOP
========================= */
let last = performance.now();
function update(t){
  const dt = Math.min(0.033, (t-last)/1000);
  last = t;

  if(!game.phoneOpen){
    const p = game.player;
    let dx = 0, dy = 0;
    if(keys.up) dy -= 1;
    if(keys.down) dy += 1;
    if(keys.left) dx -= 1;
    if(keys.right) dx += 1;

    // normalize
    const len = Math.hypot(dx,dy);
    if(len>0){ dx/=len; dy/=len; }

    p.x = clamp(p.x + dx*p.speed*dt, 20, game.mapW-20);
    p.y = clamp(p.y + dy*p.speed*dt, 20, game.mapH-20);
  }

  // simple NPC wandering
  for(const n of game.npcs){
    n.dirT -= dt;
    if(n.dirT <= 0){
      n.dirT = 1 + Math.random()*2;
      const a = Math.random()*Math.PI*2;
      n.vx = Math.cos(a)*60;
      n.vy = Math.sin(a)*60;
    }
    // move
    n.x = clamp(n.x + n.vx*dt, 20, game.mapW-20);
    n.y = clamp(n.y + n.vy*dt, 20, game.mapH-20);
  }

  requestAnimationFrame(update);
}

/* =========================
   START
========================= */
updateHUD();
requestAnimationFrame(update);
requestAnimationFrame(draw);
</script>
</body>
</html>
